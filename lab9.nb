(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54755,       1196]
NotebookOptionsPosition[     54229,       1175]
NotebookOutlinePosition[     54568,       1190]
CellTagsIndexPosition[     54525,       1187]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0421\:0430\:043c\:0430\:044f", " ", 
     "\:043f\:0440\:043e\:0441\:0442\:0430\:044f", " ", "\:0432", " ", 
     "\:0440\:0435\:0430\:043b\:0438\:0437\:0430\:0446\:0438\:0438", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", " ", 
     "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044f", " ", 
     "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0438\:0445", " ", 
     RowBox[{
     "\:0442\:043e\:0447\:0435\:043a", ".", " ", 
      "\:0420\:0435\:0430\:043b\:0438\:0437\:043e\:0432\:0430\:043d\:0430"}], 
     " ", "\:0434\:0432\:043e\:0439\:043d\:044b\:043c", " ", 
     RowBox[{
     "\:0446\:0438\:043a\:043b\:043e\:043c", ".", " ", 
      "\:0421\:043b\:043e\:0436\:043d\:043e\:0441\:0442\:044c"}]}], " ", "-", 
    " ", 
    RowBox[{"O", 
     RowBox[{"(", 
      SuperscriptBox["n", "2"], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SimpleMinDistance", "[", "Ar_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"im", "=", "1"}], ",", 
        RowBox[{"jm", "=", "2"}], ",", 
        RowBox[{"de", "=", 
         RowBox[{"EuclideanDistance", "[", 
          RowBox[{
           RowBox[{"Ar", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Ar", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Ar", "]"}], "<=", "1"}], ",", 
        RowBox[{"Return", "[", "0", "]"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0435\:0441\:043b\:0438", " ", 
           "\:0442\:043e\:043b\:044c\:043a\:043e", " ", 
           "\:043e\:0434\:0438\:043d", " ", 
           "\:044d\:043b\:0435\:043c\:0435\:043d\:0442", " ", "\:0432", " ", 
           "\:043c\:0430\:0441\:0441\:0438\:0432\:0435", " ", 
           "\:0438\:043b\:0438", " ", "\:043e\:043d", " ", 
           "\:043f\:0443\:0441\:0442\:043e\:0439"}], ",", " ", 
          RowBox[{
          "\:0442\:043e", " ", 
           "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442", " ", 
           "\:043d\:0443\:043b\:0435\:0432\:043e\:0439"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<", 
            RowBox[{"Length", "[", "Ar", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "[", "Ar", "]"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EuclideanDistance", "[", 
                 RowBox[{
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "<", 
                RowBox[{"EuclideanDistance", "[", 
                 RowBox[{
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "im", "]"}], "]"}], ",", 
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "jm", "]"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"im", "=", "i"}], 
                RowBox[{"(*", 
                 RowBox[{
                 "\:0438\:043d\:0434\:0435\:043a\:0441", " ", 
                  "\:043f\:0435\:0440\:0432\:043e\:0439", " ", 
                  "\:0442\:043e\:0447\:043a\:0438", " ", "\:0438\:0437", " ", 
                  "\:0434\:0432\:0443\:0445", " ", 
                  "\:0441\:0430\:043c\:044b\:0445", " ", 
                  "\:0431\:043b\:0438\:0437\:043a\:0438\:0445"}], "*)"}], ";", 
                RowBox[{"jm", "=", "j"}], 
                RowBox[{"(*", 
                 RowBox[{
                 "\:0438\:043d\:0434\:0435\:043a\:0441", " ", 
                  "\:0432\:0442\:043e\:0440\:043e\:0439", " ", 
                  "\:0442\:043e\:0447\:043a\:0438", " ", "\:0438\:0437", " ", 
                  "\:0434\:0432\:0443\:0445", " ", 
                  "\:0441\:0430\:043c\:044b\:0445", " ", 
                  "\:0431\:043b\:0438\:0437\:043a\:0438\:0445"}], "*)"}], ";", 
                RowBox[{"de", "=", 
                 RowBox[{"EuclideanDistance", "[", 
                  RowBox[{
                   RowBox[{"Ar", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"Ar", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                   "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\
\:043e\:0435", " ", "\:0435\:0432\:043a\:043b\:0438\:0434\:043e\:0432\:043e", 
                    " ", "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\
\:0438\:0435"}], "*)"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"de", ",", 
            RowBox[{"{", 
             RowBox[{"im", ",", "jm"}], "}"}]}], "}"}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "\:0432", " ", 
          "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:0435", " ",
           "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0430\:0435\:043c", 
          " ", "\:0441\:043f\:0438\:0441\:043e\:043a"}], ",", " ", 
         RowBox[{
          RowBox[{
          "\:043d\:0430", " ", "\:043f\:0435\:0440\:0432\:043e\:0439", " ", 
           "\:043f\:043e\:0437\:0438\:0446\:0438\:0438"}], " ", "-", " ", 
          "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435"}], 
         ",", " ", 
         RowBox[{
         "\:043d\:0430", " ", "\:0432\:0442\:043e\:0440\:043e\:0439", " ", 
          "\:043f\:043e\:0437\:0438\:0446\:0438\:0438", " ", 
          "\:0435\:0449\:0435", " ", "\:043e\:0434\:0438\:043d", " ", 
          "\:0441\:043f\:0438\:0441\:043e\:043a", " ", "\:0434\:043b\:044f", 
          " ", "\:0438\:043d\:0434\:0435\:043a\:0441\:043e\:0432", " ", 
          "\:043f\:043e\:043b\:0443\:0447\:0435\:043d\:043d\:044b\:0445", " ",
           "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.637754917189871*^9, 3.6377549490002213`*^9}, {
  3.637754991614847*^9, 3.637755139588526*^9}, {3.6377552035995703`*^9, 
  3.637755304979244*^9}, {3.6377553352177067`*^9, 3.637755585652719*^9}, {
  3.637755773873457*^9, 3.637755813815757*^9}, {3.637755849600292*^9, 
  3.637755877288706*^9}, {3.637755946109036*^9, 3.63775595151446*^9}, {
  3.6377567123356457`*^9, 3.637756782928309*^9}, {3.637756892060918*^9, 
  3.637756920734549*^9}, {3.637763895041273*^9, 3.6377638987043877`*^9}, {
  3.6380232675061617`*^9, 3.638023566353425*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0430\:0435\:0442", " ", 
     "\:0438\:043d\:0434\:0435\:043a\:0441", " ", 
     "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:0430", " ", 
     "\:043c\:0430\:0441\:0441\:0438\:0432\:0430"}], ",", " ", 
    RowBox[{
    "\:0435\:0441\:043b\:0438", " ", 
     "\:0442\:0430\:043a\:043e\:0432\:043e\:0439", " ", 
     "\:0438\:043c\:0435\:0435\:0442\:0441\:044f"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetIndexByValue", "[", 
     RowBox[{"A_", ",", "val_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "val"}], ",", 
           RowBox[{"Return", "[", "i", "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6380210347809753`*^9, 3.638021069486467*^9}, {
  3.638021241145187*^9, 3.638021257336215*^9}, {3.638021298914795*^9, 
  3.638021312862257*^9}, {3.638021427162881*^9, 3.6380214657009363`*^9}, {
  3.6380235762701902`*^9, 3.638023596374308*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0411\:043e\:043b\:0435\:0435", " ", 
     "\:0441\:043b\:043e\:0436\:043d\:044b\:0439", " ", "\:0432", " ", 
     "\:0440\:0435\:0430\:043b\:0438\:0437\:0430\:0446\:0438\:0438"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "\:043d\:043e", " ", "\:0431\:044b\:0441\:0442\:0440\:044b\:0439", " ", 
      "\:0440\:0435\:043a\:0443\:0440\:0441\:0438\:0432\:043d\:044b\:0439", 
      " ", 
      RowBox[{
      "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c", ".", " ", 
       "\:0421\:043b\:043e\:0436\:043d\:043e\:0441\:0442\:044c"}]}], " ", "-",
      " ", 
     RowBox[{"O", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "*", "log", 
         RowBox[{"(", "n", ")"}]}], ")"}], ".", " ", 
       "\:041e\:0447\:0435\:043d\:044c"}], " ", 
      "\:043f\:043e\:0434\:0440\:043e\:0431\:043d\:043e", " ", 
      "\:043e\:043f\:0438\:0441\:0430\:043d", " ", "\:0432", " ", 
      "\:043a\:043d\:0438\:0433\:0435", " ", 
      "\:041a\:043e\:0440\:043c\:0435\:043d", " ", 
      "\"\<\:0410\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:044b. \:041f\
\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435 \:0438 \:0430\:043d\
\:0430\:043b\:0438\:0437. - 2013\>\"", " ", "\:0441\:0442\:0440", ".1086", 
      RowBox[{"(", 
       RowBox[{"\:0443", " ", "\:043c\:0435\:043d\:044f"}], ")"}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FastMinDistance", "[", 
     RowBox[{"Ar_", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "\:043d\:0435\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:043e\:0435", " ", "\:043c\:043d"}], "-", 
        RowBox[{"\:0432\:043e", " ", "\:0442\:043e\:0447\:0435\:043a"}]}], 
       "*)"}], ",", "X_", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "\:044d\:0442\:043e", " ", "\:0436\:0435", " ", "\:043c\:043d"}], "-", 
        RowBox[{
        "\:0432\:043e", " ", 
         "\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:043d\
\:043e\:0435", " ", "\:0432", " ", 
         "\:043f\:043e\:0440\:044f\:0434\:043a\:0435", " ", 
         "\:0432\:043e\:0437\:0440\:0430\:0441\:0442\:0430\:043d\:0438\:044f",
          " ", "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b",
          " ", "\:0425"}]}], "*)"}], ",", "Y_"}], 
     RowBox[{"(*", 
      RowBox[{
      "\:0432", " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0435", " ", 
       "\:0432\:043e\:0437\:0440\:0430\:0441\:0442\:0430\:043d\:0438\:044f", 
       " ", "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", 
       " ", "Y"}], "*)"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "dl", ",", "dr", ",", "dk", ",", "im", ",", "jm", ",", "mid",
         ",", 
        RowBox[{"Pl", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Pr", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Xl", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Xr", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Yl", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Yr", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Pcur", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Ycheck", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Ar", "]"}], "\[LessEqual]", "3"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"SimpleMinDistance", "[", "Ar", "]"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "\:0435\:0441\:043b\:0438", " ", "\:0434\:043b\:0438\:043d\:0430", 
            " ", "\:0432\:0445\:043e\:0434\:044f\:0449\:0435\:0433\:043e", 
            " ", "\:043c\:0430\:0441\:0441\:0438\:0432\:0430", " ", 
            "\:043d\:0435", " ", 
            "\:043f\:0440\:0435\:0432\:044b\:0448\:0430\:0435\:0442", " ", 
            "3"}], ",", " ", 
           RowBox[{
           "\:0442\:043e", " ", 
            "\:0440\:0430\:0431\:043e\:0442\:0430\:0435\:0442", " ", 
            "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c", " ", 
            "\:043f\:0440\:043e\:0441\:0442\:043e\:0433\:043e", " ", 
            "\:043f\:0435\:0440\:0435\:0431\:043e\:0440\:0430"}]}], "*)"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "(*", "\:0420\:0430\:0437\:0434\:0435\:043b\:0435\:043d\:0438\:0435", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:043d\:0443\:0436\:043d\:043e", " ", 
          "\:0440\:0430\:0437\:0434\:0435\:043b\:0438\:0442\:044c", " ", 
          "\:043c\:0430\:0441\:0441\:0438\:0432", " ", "\:043d\:0430", " ", 
          "2", " ", "\:0440\:0430\:0432\:043d\:044b\:0435", " ", 
          RowBox[{
          "\:0447\:0430\:0441\:0442\:0438", ".", " ", 
           "\:041f\:043e\:0441\:043a\:043e\:043b\:044c\:043a\:0443"}], " ", 
          "\:0443", " ", "\:043d\:0430\:0441", " ", 
          "\:0435\:0441\:0442\:044c", " ", 
          "\:043e\:0442\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:044b\:0439", " ", "\:043f\:043e", " ", "\:0425", " ", 
          "\:043c\:0430\:0441\:0441\:0438\:0432", " ", 
          "\:0441\:0434\:0435\:043b\:0430\:0442\:044c", " ", 
          "\:044d\:0442\:043e", " ", "\:043e\:0447\:0435\:043d\:044c", " ", 
          "\:043f\:0440\:043e\:0441\:0442\:043e"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mid", "=", 
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", "X", "]"}], "+", "1"}], ")"}], "/", 
               "2"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{
              "\:0431\:0435\:0440\:0435\:043c", " ", 
               "\:044d\:043b\:0435\:043c\:0435\:043d\:0442", " ", "\:0441", 
               " ", "\:0438\:043d\:0434\:0435\:043a\:0441\:043e\:043c", " ", 
               "\:0440\:0430\:0432\:043d\:044b\:043c", " ", 
               "\:043f\:043e\:043b\:043e\:0432\:0438\:043d\:0435", " ", 
               "\:0434\:043b\:0438\:043d\:044b", " ", 
               "\:043c\:0430\:0441\:0441\:0438\:0432\:0430", " ", "\:0441", 
               " ", "\:043e\:043a\:0440\:0443\:0433\:043b\:0435\:043d\:0438\
\:0435\:043c", " ", "\:0432", " ", 
               "\:0431\:043e\:043b\:044c\:0448\:0443\:044e", " ", 
               "\:0441\:0442\:043e\:0440\:043e\:043d\:0443"}], "*)"}], ",", 
             "1"}], 
            RowBox[{"(*", 
             RowBox[{
             "\:0431\:0435\:0440\:0435\:043c", " ", 
              "\:0425\:043e\:0432\:0443\:044e", " ", 
              "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0443"}]\
, "*)"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "\:0442\:0435\:043f\:0435\:0440\:044c", " ", 
            "\:043d\:0443\:0436\:043d\:043e", " ", 
            "\:0440\:0430\:0437\:0431\:0438\:0442\:044c", " ", 
            "\:0438\:0441\:0445\:043e\:0434\:043d\:044b\:0439", " ", 
            "\:043c\:0430\:0441\:0441\:0438\:0432", " ", "\:043d\:0430", " ", 
            "\:0434\:0432\:0430", " ", 
            "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:0430"}], 
           ",", " ", 
           RowBox[{
           "\:0430", " ", "\:0442\:043e\:0447\:043d\:0435\:0435", " ", 
            "\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\:0430\:043d\
\:043d\:044b\:0435", " ", "\:0447\:0430\:0441\:0442\:0438", " ", "X"}], ",", 
           " ", 
           RowBox[{
           "Y", " ", "\:0442\:043e\:0436\:0435", " ", 
            "\:043d\:0443\:0436\:043d\:043e", " ", 
            "\:0440\:0430\:0437\:0431\:0438\:0442\:044c", " ", "\:043d\:0430",
             " ", "2", " ", "\:0447\:0430\:0441\:0442\:0438", " ", "\:0441", 
            " ", "\:0441\:043e\:0445\:0440\:0430\:043d\:0435\:043d\:0438\:0435\
\:043c", " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0430", " ", 
            "\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\:0430\:043d\
\:043d\:044b\:0445", " ", 
            "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:043e\:0432"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "Ar", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "\:043f\:043e\:0434\:0440\:043e\:0431\:043d\:043e", " ", 
               "\:043e\:043f\:0438\:0448\:0443", " ", 
               "\:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435", " ", 
               "\:043d\:0435\:0441\:043e\:0440\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:043e\:0433\:043e", " ", 
               "\:0441\:043f\:0438\:0441\:043a\:0430", 
               RowBox[{"(", 
                RowBox[{
                "2", " ", 
                 "\:043e\:0441\:0442\:0430\:043b\:044c\:043d\:044b\:0445", 
                 " ", "\:043f\:043e", " ", 
                 "\:0430\:043d\:0430\:043b\:043e\:0433\:0438\:0438"}], 
                ")"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Ar", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", "mid"}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "\:0441\:0440\:0435\:0434\:043d\:044f\:044f", " ", 
                 "\:0442\:043e\:0447\:043a\:0430", " ", 
                 "\:0434\:043e\:043b\:0436\:043d\:0430", " ", 
                 "\:043f\:043e\:043f\:0430\:0441\:0442\:044c", " ", "\:0432", 
                 " ", "\:043e\:0431\:0430", " ", 
                 "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:0430\
"}], ",", " ", 
                RowBox[{
                "\:043f\:043e\:044d\:0442\:043e\:043c\:0443", " ", 
                 "\:0435\:0441\:043b\:0438", " ", "\:0435\:0435", " ", 
                 "\:0425\:043e\:0432\:0430\:044f", " ", 
                 "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0430\
", " ", "\:0440\:0430\:0432\:043d\:0430", " ", 
                 "\:0441\:0440\:0435\:043d\:0435\:0439"}], ",", " ", 
                RowBox[{
                "\:0442\:043e", " ", "\:0442\:0430\:043a\:0430\:044f", " ", 
                 "\:0442\:043e\:0447\:043a\:0430", " ", 
                 "\:0432\:043e\:0439\:0434\:0435\:0442", " ", "\:0432", " ", 
                 "\:043e\:0431\:0430", " ", "\:0438\:0437", " ", 
                 "\:043d\:0438\:0445"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Pl", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Pl", ",", 
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Pr", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Pr", ",", 
                  RowBox[{"Ar", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Ar", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", "mid"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "\:0435\:0441\:043b\:0438", " ", "\:0435\:0435", " ", 
                 "\:0425\:043e\:0432\:0430\:044f", " ", 
                 "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0430\
", " ", "\:043c\:0435\:043d\:044c\:0448\:0435", " ", 
                 "\:0441\:0440\:0435\:043d\:0435\:0439"}], ",", " ", 
                RowBox[{
                "\:0442\:043e", " ", "\:0435\:0441\:0442\:044c", " ", 
                 "\:043b\:0435\:0432\:0435\:0435"}], ",", " ", 
                RowBox[{
                "\:0442\:043e", " ", "\:0442\:0430\:043a\:0430\:044f", " ", 
                 "\:0442\:043e\:0447\:043a\:0430", " ", 
                 "\:0432\:043e\:0439\:0434\:0435\:0442", " ", 
                 "\:043b\:0435\:0432\:044b\:0439", " ", 
                 "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432"}]}],
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Pl", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Pl", ",", 
                 RowBox[{"Ar", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Ar", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", "mid"}], ",", 
              RowBox[{"(*", 
               RowBox[{
               "\:043e\:0431\:0440\:0430\:0442\:043d\:043e", " ", "\[Rule]", 
                " ", 
                RowBox[{
                "\:0432", " ", "\:043f\:0440\:0430\:0432\:044b\:0439"}]}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Pr", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Pr", ",", 
                 RowBox[{"Ar", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", "mid"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Yl", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Yl", ",", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Yr", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Yr", ",", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[LessEqual]", 
               "mid"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Yl", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Yl", ",", 
                 RowBox[{"Y", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[GreaterEqual]", 
               "mid"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Yr", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Yr", ",", 
                 RowBox[{"Y", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", "mid"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Xl", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Xl", ",", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Xr", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Xr", ",", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[LessEqual]", 
               "mid"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Xl", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Xl", ",", 
                 RowBox[{"X", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[GreaterEqual]", 
               "mid"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Xr", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"Xr", ",", 
                 RowBox[{"X", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
         "(*", "\:0412\:043b\:0430\:0441\:0442\:0432\:043e\:0432\:0430\:043d\
\:0438\:0435", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "\:0434\:043b\:044f", " ", 
           "\:043a\:0430\:0436\:0434\:043e\:0433\:043e", " ", "\:0438\:0437", 
           " ", "2", "\:0443\:0445", " ", 
           "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:043e\:0432\
", " ", "\:0434\:0435\:043b\:0430\:0435\:0442\:0441\:044f", " ", 
           "\:0441\:0432\:043e\:0439", " ", 
           "\:0440\:0435\:043a\:0443\:0440\:0441\:0438\:0432\:043d\:044b\:0439\
", " ", "\:0432\:044b\:0437\:043e\:0432"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dl", "=", 
          RowBox[{"FastMinDistance", "[", 
           RowBox[{"Pl", ",", "Xl", ",", "Yl"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dr", "=", 
          RowBox[{"FastMinDistance", "[", 
           RowBox[{"Pr", ",", "Xr", ",", "Yr"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "\:043f\:043e\:0441\:043a\:043e\:043b\:044c\:043a\:0443", " ", 
            "\:0432", " ", 
            "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:0435", 
            " ", "\:043f\:043e\:0441\:0442\:043e\:044f\:043d\:043d\:043e\:0433\
\:043e", " ", "\:0434\:0435\:043b\:0435\:043d\:0438\:044f", " ", 
            "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:0430", " ", 
            "\:043d\:0430", " ", "\:0432\:0441\:0435", " ", 
            "\:0431\:043e\:043b\:0435\:0435", " ", 
            "\:043c\:0435\:043b\:043a\:0438\:0435", " ", 
            "\:043f\:043e\:0434\:043c\:043d\:043e\:0436\:0435\:0441\:0442\
\:0432\:0430"}], ",", 
           RowBox[{
           "\:0432", " ", "\:0438\:0442\:043e\:0433\:0435", " ", 
            "\:043f\:0440\:043e\:0438\:0437\:043e\:0439\:0434\:0435\:0442", 
            " ", "\:0432\:044b\:0437\:043e\:0432", " ", 
            "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", " ", 
            "SimpleMinDistance", " ", "\:0438", " ", "\:044d\:0442\:0438", 
            " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435\
", " ", "\:0431\:0443\:0434\:0443\:0442", " ", 
            "\:0438\:043c\:0435\:0442\:044c", " ", 
            RowBox[{"\:0432\:0438\:0434", ":", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435\
", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\:0438\:043d\:0434\:0435\:043a\:0441", ",", " ", 
                   "\:0438\:043d\:0434\:0435\:043a\:0441"}], "}"}]}], "}"}], 
               ".", " ", "\:041f\:0440\:0438"}], " ", "\:0447\:0435\:043c", 
              " ", "\:0438\:043d\:0434\:0435\:043a\:0441\:044b", " ", 
              "\:043f\:043e\:043b\:0443\:0447\:0430\:0442\:0441\:044f", " ", 
              "\:0441\:043e\:0432\:0435\:0440\:0448\:0435\:043d\:043d\:043e", 
              " ", "\:043b\:0435\:0432\:044b\:0435", " ", "\:0438", " ", 
              "\:043d\:0435\:043d\:0443\:0436\:043d\:044b\:0435"}]}]}], ",", 
           " ", 
           RowBox[{
           "\:043f\:043e\:0442\:043e\:043c\:0443", " ", "\:0447\:0442\:043e", 
            " ", "\:043f\:0440\:0438", " ", 
            "\:0432\:044b\:0437\:043e\:0432\:0435", " ", 
            "\:043f\:043e\:0439\:0434\:0435\:0442", " ", 
            "\:043c\:0430\:0441\:0441\:0438\:0432", " ", 
            "\:0442\:0438\:043f\:0430", " ", "Pl", " ", "\:0438\:043b\:0438", 
            " ", "Pr"}], ",", " ", 
           RowBox[{
           "\:0438\:043d\:0434\:0435\:043a\:0441\:0430\:0446\:0438\:044f", 
            " ", "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:043c", 
            " ", "\:043e\:0442\:043b\:0438\:0447\:043d\:0430", " ", 
            "\:043e\:0442", " ", 
            "\:043e\:0441\:043d\:043e\:0432\:043d\:043e\:0433\:043e", " ", 
            "Ar"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dl", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", 
            RowBox[{"dr", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
            "\:0432", " ", 
             "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", 
             " ", "d", " ", "\:0432\:043e\:0439\:0434\:0435\:0442", " ", 
             "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0435", " ", "\:0438\:0437", " ", "2", "\:0443\:0445", " ", 
             "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0439"}],
             "*)"}], ",", 
           RowBox[{
            RowBox[{"d", "=", "dl"}], ";", 
            RowBox[{"Pcur", "=", "Pl"}]}], 
           RowBox[{"(*", 
            RowBox[{
            "\:0432", " ", "Pcur", " ", "\:043c\:044b", " ", 
             "\:0437\:0430\:043d\:043e\:0441\:0438\:043c", " ", 
             "\:043c\:0430\:0441\:0441\:0438\:0432", " ", "\:0438\:0437", " ",
              "\:043a\:043e\:0442\:043e\:0440\:043e\:0433\:043e", " ", 
             "\:043f\:043e\:043b\:0443\:0447\:0438\:043b\:043e\:0441\:044c", 
             " ", "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\
\:043e\:0435", " ", 
             RowBox[{
             "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435", 
              ".", " ", "\:041e\:043d"}], " ", 
             "\:043f\:0440\:0438\:0433\:043e\:0434\:0438\:0442\:044c\:0441\
\:044f", " ", "\:043f\:043e\:0442\:043e\:043c", " ", 
             "\:043a\:043e\:0433\:0434\:0430", " ", 
             "\:0431\:0443\:0434\:0435\:043c", " ", 
             "\:0432\:043e\:0441\:0441\:0442\:0430\:043d\:0430\:0432\:043b\
\:0438\:0432\:0430\:0442\:044c", " ", 
             "\:0438\:043d\:0434\:0435\:043a\:0441\:0430\:0446\:0438\:044e"}],
             "*)"}], ",", 
           RowBox[{
            RowBox[{"d", "=", "dr"}], ";", 
            RowBox[{"Pcur", "=", "Pr"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "(*", "\:041a\:043e\:043c\:0431\:0438\:043d\:0438\:0440\:043e\:0432\
\:0430\:043d\:0438\:0435", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "\:043d\:0430", " ", "\:0442\:043e\:0442", " ", 
            "\:0441\:043b\:0443\:0447\:0430\:0439", " ", 
            "\:0435\:0441\:043b\:0438", " ", 
            "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0435", " ", "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435", 
            " ", "\:043d\:0430", " ", "\:0441\:0430\:043c\:043e\:043c", " ", 
            "\:0434\:0435\:043b\:0435", " ", 
            "\:043f\:043e\:043b\:0443\:0447\:0430\:0435\:0442\:0441\:044f", 
            " ", "\:043d\:0435", " ", "\:0432", " ", 
            "\:043a\:0430\:043a\:043e\:043c", " ", "\:0442\:043e", " ", 
            "\:0438\:0437", " ", "\:0434\:0432\:0443\:0445", " ", 
            "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:043e\
\:0432"}], ",", " ", 
           RowBox[{
           "\:0430", " ", "\:043c\:0435\:0436\:0434\:0443", " ", 
            "\:043d\:0438\:043c\:0438", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "\:043e\:0434\:043d\:0430", " ", 
               "\:0442\:043e\:0447\:043a\:0430", " ", "\:0432", " ", 
               "\:043e\:0434\:043d\:043e\:043c"}], ",", " ", 
              RowBox[{
              "\:0434\:0440\:0443\:0433\:0430\:044f", " ", "\:0432", " ", 
               "\:0434\:0440\:0443\:0433\:043e\:043c"}]}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "Y", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "\:0441\:043e\:0441\:0442\:0430\:0432\:043b\:044f\:0435\:043c", 
              " ", "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
              "\:0432\:0441\:0435\:0445", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d"}], ",", " ", 
             RowBox[{
             "\:0440\:0430\:0441\:043f\:043e\:043b\:043e\:0436\:0435\:043d\
\:043d\:044b\:0445", " ", "\:0432", " ", 
              "\:043f\:043e\:0440\:044f\:0434\:043a\:0435", " ", 
              
              "\:0432\:043e\:0437\:0440\:0430\:0441\:0442\:0430\:043d\:0438\
\:044f", " ", "\:043f\:043e", " ", "Y", " ", "\:0438", " ", "\:043d\:0435", 
              " ", "\:0431\:043e\:043b\:0435\:0435", " ", 
              "\:0447\:0435\:043c", " ", "\:043d\:0430", " ", 
              "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0438", 
              " ", "d", " ", "\:043e\:0442", " ", 
              "\:0441\:0440\:0435\:0434\:043d\:0435\:0439", " ", 
              "\:043b\:0438\:043d\:0438\:0438"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"mid", "-", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], 
              "\[LessEqual]", 
              RowBox[{"d", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "\:043f\:0435\:0440\:0432\:044b\:0439", " ", 
                "\:044d\:043b\:0435\:043c\:0435\:043d\:0442", " ", "d"}], " ",
                "-", " ", 
               RowBox[{
               "\:044d\:0442\:043e", " ", 
                "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435\
"}]}], "*)"}], ",", 
             RowBox[{"Ycheck", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"Ycheck", ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Ycheck", "]"}], ">", "2"}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", "\:0432", " ", 
              "\:043c\:0430\:0441\:0441\:0438\:0432", " ", "Ycheck", " ", 
              "\:043f\:043e\:043f\:0430\:043b\:0430", " ", 
              "\:043e\:0434\:043d\:0430", " ", 
              "\:0442\:043e\:0447\:043a\:0430"}], ",", " ", 
             RowBox[{"\:0442\:043e", " ", "\:044d\:0442\:043e", " ", 
              RowBox[{
              "\:0441\:0440\:0435\:0434\:043d\:044f\:044f", ".", " ", 
               "\:0415\:0441\:043b\:0438"}], " ", "2"}], ",", " ", 
             RowBox[{
              RowBox[{
              "\:0442\:043e", " ", "\:044d\:0442\:043e", " ", 
               "\:0441\:0440\:0435\:0434\:043d\:044f\:044f", " ", "\:0438", 
               " ", "\:0435\:0449\:0435", " ", 
               "\:043a\:0430\:043a\:0430\:044f"}], "-", 
              RowBox[{
               RowBox[{
               "\:0442\:043e", ".", " ", 
                "\:041f\:043e\:0441\:043a\:043e\:043b\:044c\:043a\:0443"}], 
               " ", "\:0441\:0440\:0435\:0434\:043d\:044f\:044f", " ", 
               "\:043b\:0435\:0436\:0438\:0442", " ", "\:0432", " ", 
               "\:043e\:0431\:043e\:0438\:0445", " ", 
               "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:0430\
\:0445"}]}], ",", " ", 
             RowBox[{
             "\:0430", " ", 
              "\"\<\:043a\:0430\:043a\:0430\:044f-\:0442\:043e\>\"", " ", 
              "\:0432", " ", "\:043e\:0434\:043d\:043e\:043c", " ", 
              "\:0438\:0437", " ", "\:043d\:0438\:0445", " ", "\:0442\:043e", 
              " ", "\:043d\:0435\:0442", " ", 
              "\:0441\:043c\:044b\:0441\:043b\:0430", " ", 
              "\:043f\:0440\:043e\:0432\:0435\:0440\:044f\:0442\:044c"}], ",",
              " ", 
             RowBox[{
             "\:043f\:043e\:0441\:043a\:043e\:043b\:044c\:043a\:0443", " ", 
              "\:044d\:0442\:0430", " ", 
              "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", " ", 
              "\:0431\:044b\:043b\:0430", " ", 
              "\:0441\:0434\:0435\:043b\:0430\:043d\:0430", " ", "\:0432", 
              " ", "\:043f\:0440\:0435\:0434\:044b\:0434\:0443\:0449\:0435\
\:043c", " ", "\:0448\:0430\:0433\:0435"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dk", "=", 
             RowBox[{"SimpleMinDistance", "[", "Ycheck", "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", "\:0438\:0445", " ", 
              "\:0431\:043e\:043b\:044c\:0448\:0435", " ", "\:0442\:043e", 
              " ", "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
              
              "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0435", " ", "\:0441\:0440\:0435\:0434\:0438", " ", "\:043d\:0438\:0445", 
              " ", "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\
\:0435"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", 
               RowBox[{"d", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"d", "=", "dk"}], ";", 
               RowBox[{"Pcur", "=", "Ycheck"}]}]}], "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
           "\:0441\:0440\:0430\:0432\:043d\:0438\:0432\:0430\:0435\:043c", 
            " ", "\:044d\:0442\:043e", " ", "\:0441", " ", 
            "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:044b\
\:043c", " ", "\:0438\:0437", " ", "\:0434\:0432\:0443\:0445", " ", 
            RowBox[{
            "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:043e\
\:0432", ".", " ", "\:0411\:0435\:0440\:0435\:043c"}], " ", 
            "\:043c\:0435\:043d\:044c\:0448\:0435\:0435"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "\:0432\:0441\:0435", " ", "\:0447\:0442\:043e", " ", 
            "\:043e\:0441\:0442\:0430\:043b\:043e\:0441\:044c"}], " ", "-", 
           " ", 
           RowBox[{
           "\:044d\:0442\:043e", " ", 
            "\:0432\:043e\:0441\:0441\:0442\:0430\:043d\:043e\:0432\:0438\
\:0442\:044c", " ", 
            "\:0438\:043d\:0434\:0435\:043a\:0441\:0430\:0446\:0438\:044e", 
            " ", "\:0438\:0441\:0445\:043e\:0434\:043d\:043e\:0433\:043e", 
            " ", "\:043c\:0430\:0441\:0441\:0438\:0432\:0430", " ", "Ar"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GetIndexByValue", "[", 
               RowBox[{"Ar", 
                RowBox[{"(*", 
                 RowBox[{
                 "\:0438\:0449\:0435\:043c", " ", 
                  "\:0438\:043d\:0434\:0435\:043a\:0441", " ", "\:0432", " ", 
                  "Ar"}], "*)"}], ",", 
                RowBox[{"Pcur", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", 
                    RowBox[{"(*", 
                    RowBox[{
                    "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\
\:0432\:0430\:0435\:043c", " ", 
                    "\:0438\:043d\:0434\:0435\:043a\:0441\:044b"}], "*)"}], 
                    ",", "1"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    "\:0431\:0435\:0440\:0435\:043c", " ", 
                    "\:043f\:0435\:0440\:0432\:044b\:0439", " ", 
                    "\:0438\:0437", " ", "\:043d\:0438\:0445"}], "*)"}], 
                    "]"}], "]"}], " ", "]"}], "]"}]}], " ", "]"}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "\:043f\:043e", " ", 
                 "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044e"}], ",", 
                " ", 
                RowBox[{
                "\:0438\:0437", " ", 
                 "\:043f\:043e\:0434\:043c\:0430\:0441\:0441\:0438\:0432\:0430\
", " ", "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:043c", " ", 
                 "\:0431\:044b\:043b\:043e", " ", 
                 "\:043d\:0430\:0439\:0434\:0435\:043d\:043e", " ", 
                 "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0435", " ", 
                 "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435\
"}]}], "*)"}], ",", 
              RowBox[{"GetIndexByValue", "[", 
               RowBox[{"Ar", ",", 
                RowBox[{"Pcur", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    "\:0442\:0435\:043f\:0435\:0440\:044c", " ", 
                    "\:0432\:0442\:043e\:0440\:043e\:0439", " ", 
                    "\:0438\:043d\:0434\:0435\:043a\:0441"}], "*)"}], "]"}], 
                   "]"}], " ", "]"}], "]"}]}], " ", "]"}]}], "}"}]}], "}"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.637756084139689*^9, 3.637756106501975*^9}, {
   3.637756373870488*^9, 3.6377563862185717`*^9}, {3.6377566476963577`*^9, 
   3.637756673467304*^9}, {3.637756958788558*^9, 3.637757074632633*^9}, {
   3.6377571214010363`*^9, 3.63775713600255*^9}, {3.637757190392497*^9, 
   3.637757232392297*^9}, {3.637757316241835*^9, 3.6377573732344427`*^9}, {
   3.63775758549946*^9, 3.6377575878167973`*^9}, {3.637757622582203*^9, 
   3.6377577044821377`*^9}, {3.637757734611114*^9, 3.637757791898201*^9}, {
   3.637757880067892*^9, 3.637757948196422*^9}, {3.637757991367721*^9, 
   3.637758060991249*^9}, {3.637758369339677*^9, 3.637758390661112*^9}, {
   3.6377584239574757`*^9, 3.63775849281643*^9}, {3.6377585250749807`*^9, 
   3.637758578335577*^9}, {3.6377586665891933`*^9, 3.63775867974748*^9}, {
   3.637758759220504*^9, 3.6377588113777857`*^9}, {3.637758899620525*^9, 
   3.6377589050062237`*^9}, {3.637759032878148*^9, 3.6377591371153173`*^9}, {
   3.637759421022442*^9, 3.6377594803801527`*^9}, {3.637759583043394*^9, 
   3.637759618627165*^9}, 3.6377597261185293`*^9, {3.63775978400139*^9, 
   3.637759806426502*^9}, {3.637759926993554*^9, 3.637759954423223*^9}, {
   3.637759984607615*^9, 3.637760086337038*^9}, {3.637760240777171*^9, 
   3.637760274258368*^9}, {3.637760366811719*^9, 3.6377604673011723`*^9}, {
   3.637760718070812*^9, 3.6377607681843033`*^9}, {3.637761707543828*^9, 
   3.637761708815103*^9}, {3.637762501450719*^9, 3.637762504558652*^9}, {
   3.637763141520262*^9, 3.6377631537906513`*^9}, {3.637763686286325*^9, 
   3.637763692563013*^9}, {3.6377638635379457`*^9, 3.637763865925963*^9}, {
   3.637763938352508*^9, 3.637764042146942*^9}, {3.638017643634287*^9, 
   3.6380176871419992`*^9}, {3.638017921143488*^9, 3.6380179242750263`*^9}, 
   3.638020861985156*^9, {3.638020922435158*^9, 3.638020933854734*^9}, {
   3.638021018270998*^9, 3.6380210281788282`*^9}, {3.638021579497581*^9, 
   3.638021771555685*^9}, 3.638022826196384*^9, {3.6380236047461233`*^9, 
   3.638024429551454*^9}, {3.6380244643887777`*^9, 3.638024692896291*^9}, {
   3.63802500321418*^9, 3.6380250238431873`*^9}, {3.638025141578546*^9, 
   3.63802519326886*^9}, {3.638025405282144*^9, 3.6380255818471193`*^9}, {
   3.63802565761837*^9, 3.638025684709385*^9}, {3.638025728603842*^9, 
   3.638026119273484*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", "100", "]"}], ",", 
       RowBox[{"RandomReal", "[", "100", "]"}]}], "}"}], ",", 
     RowBox[{"{", "36", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{"A", ",", "First"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "=", 
    RowBox[{"SortBy", "[", 
     RowBox[{"A", ",", "Last"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0435\:0441\:043b\:0438", " ", 
     "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:044b", " ", 
     "\:043c\:0430\:0441\:0441\:0438\:0432\:0430", " ", 
     "\:0438\:043c\:0435\:044e\:0442", " ", "\:0432\:0438\:0434", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["a", "i"], ",", 
       SubscriptBox["b", "i"]}], "}"}]}], ",", " ", 
    RowBox[{"\:0442\:043e", " ", 
     RowBox[{"SortBy", "[", " ", 
      RowBox[{"_", " ", ",", "First"}], "]"}], " ", 
     "\:043e\:0437\:043d\:0430\:0447\:0430\:0435\:0442", " ", 
     "\:0447\:0442\:043e", " ", 
     "\:0441\:043e\:0440\:0442\:0438\:0440\:0443\:0435\:043c", " ", "\:0432", 
     " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0435", " ", 
     "\:0432\:043e\:0437\:0440\:0430\:0441\:0442\:0430\:043d\:0438\:044f", 
     " ", "\:043f\:043e\:0434\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:043e\
\:0432", " ", 
     RowBox[{
      SubscriptBox["a", "i"], ".", " ", "\:0410"}], " ", 
     RowBox[{"SortBy", "[", " ", 
      RowBox[{"_", " ", ",", "Last"}], "]"}], " ", 
     "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\:0432\:0435\:043d\
\:043d\:043e", " ", "\:043f\:043e", " ", 
     SubscriptBox["b", "i"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}], "=", 
   RowBox[{
    RowBox[{"SimpleMinDistance", "[", "A", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0432", " ", "\:043a\:0430\:0447\:0435\:0441\:0442\:0432\:0435", " ", 
     "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0438", " ", 
     "\:043f\:0440\:0430\:0432\:0438\:043b\:044c\:043d\:043e\:0441\:0442\:0438\
", " ", "\:0431\:044b\:0441\:0442\:0440\:043e\:0433\:043e", " ", 
     "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:0430", " ", 
     "\:043c\:043e\:0436\:043d\:043e", " ", 
     "\:0441\:0434\:0435\:043b\:0430\:0442\:044c", " ", 
     "\:0432\:044b\:0437\:043e\:0432", " ", 
     "\:043c\:0435\:0434\:043b\:0435\:043d\:043d\:043e\:0433\:043e"}], ",", 
    " ", 
    RowBox[{
    "\:043d\:043e", " ", 
     "\:043e\:0434\:043d\:043e\:0437\:043d\:0430\:0447\:043d\:043e", " ", 
     "\:043f\:0440\:0430\:0432\:0438\:043b\:044c\:043d\:043e\:0433\:043e"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "=", 
   RowBox[{
    RowBox[{"FastMinDistance", "[", 
     RowBox[{"A", ",", "X", ",", "Y"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0431\:0435\:0440\:0435\:043c", " ", 
     "\:0432\:0442\:043e\:0440\:0443\:044e", " ", 
     "\:0447\:0430\:0441\:0442\:044c"}], ",", " ", 
    RowBox[{
    "\:043f\:043e\:0442\:043e\:043c\:0443", " ", "\:0447\:0442\:043e", " ", 
     "\:043d\:0430\:0441", " ", "\:0432", " ", 
     "\:0434\:0430\:043d\:043d\:043e\:0439", " ", 
     "\:0441\:0438\:0442\:0443\:0430\:0446\:0438\:0438", " ", "\:043d\:0435", 
     " ", "\:0438\:043d\:0442\:0435\:0440\:0435\:0441\:0443\:0435\:0442", " ",
      "\:0441\:0430\:043c\:043e", " ", 
     "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:0435"}], ",", 
    " ", 
    RowBox[{
    "\:0430", " ", "\:0441\:043a\:043e\:0440\:0435\:0435", " ", 
     "\:0438\:043d\:0434\:0435\:043a\:0441\:044b", " ", 
     "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:043e\:0432"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Point", "[", "A", "]"}], ",", "Red", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", "x", "]"}], "]"}], ",", 
        RowBox[{"A", "[", 
         RowBox[{"[", "y", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "105"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "105"}], "}"}]}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.6377547524311123`*^9, 3.6377547898741903`*^9}, {
   3.637754852698316*^9, 3.637754856871999*^9}, 3.637754914733034*^9, {
   3.637755610506185*^9, 3.6377556794073877`*^9}, {3.637755995736142*^9, 
   3.637756056320969*^9}, {3.6377567730380707`*^9, 3.63775677409823*^9}, {
   3.637756812238885*^9, 3.637756815087975*^9}, {3.637756852191918*^9, 
   3.6377568635097227`*^9}, {3.637756931317815*^9, 3.6377569316586237`*^9}, {
   3.637757486996427*^9, 3.637757487114945*^9}, {3.63776012079316*^9, 
   3.637760142433455*^9}, {3.637760314521373*^9, 3.6377603321919947`*^9}, 
   3.63776050698067*^9, {3.637760854423809*^9, 3.6377609593781853`*^9}, {
   3.637761005456388*^9, 3.6377610480875072`*^9}, {3.637761117353228*^9, 
   3.637761122298016*^9}, {3.637761721331065*^9, 3.6377617720547123`*^9}, 
   3.637762538093548*^9, {3.637762725529014*^9, 3.637762758205098*^9}, {
   3.637763230478603*^9, 3.6377632677184153`*^9}, 3.637763823801818*^9, 
   3.637763915833139*^9, 3.638017543041342*^9, {3.638017715818349*^9, 
   3.638017717230414*^9}, 3.638018063488592*^9, 3.638022919137451*^9, {
   3.638022960023616*^9, 3.63802296158624*^9}, {3.638023082429408*^9, 
   3.638023103931138*^9}, {3.638026142699031*^9, 3.6380264275391073`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"31", ",", "34"}], "}"}]], "Output",
 CellChangeTimes->{3.6380231180777407`*^9, 3.638026430842369*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"31", ",", "34"}], "}"}]], "Output",
 CellChangeTimes->{3.6380231180777407`*^9, 3.63802643087433*^9}],

Cell[BoxData[
 GraphicsBox[{PointBox[CompressedData["
1:eJwBUQKu/SFib1JlAgAAACQAAAACAAAAuOQVjxk/PEDsCqFmIXtAQEpr9SBU
SlVA9G74s7LKNEBGp9l8Od9YQHDrzPasgTRA8H3gS7iZGUB6eAXOgxxTQDj8
OwswC1NAOAAx3Na+WED0p5452p5IQDzQMqOiDExAuhWmvT2UU0Ay8o09W1hR
QL4Go0QajlhAgNqbyfOXI0D8PaFHMstCQFAE+SUKDCRAgDHFAESs+z/wZVZK
7vowQDTUzIXJm05A3LRMaHS1VUC8bkPLoRZEQLzSGVdiElNActAQ8jlTUEC0
pcrNv2FRQJCIwGiWFxhATOeySnH+NUC4lqEmKjZRQDxDrAxx0UFADB9T6mpU
TUBwNO25kjgSQCQx7GSwqEFAriU+p3KFUkBow+VFWO1JQICE3iqZoVNAmOFj
Vz3HV0BgAoObDmccQJzNtpB0Y1ZAkMTTpxnSPkA4pc74HFxTQFRCaDGWqDpA
+Kx1a8YBKUBU4lnolEo3QLwKBxbcHUdAsG0jYfY3RUAItWHL2JQ3QDB8K5ml
sVdA3Flcdv5DNECogFImZkxLQNBEYJ1xXiNAIHWRmrAOVUBwzmEKo6tFQJzb
ABfBKkBAPjfNrbKTVkB4T2qU3/QxQIDrbmjnGEtA4kfaTjSdV0C+Adf3nU1R
QHBMV8tpclVAiv9IXX1eUUCIKgyRqVZOQGJGv7E3RlFAqGgBYVMHP0AgW76V
Y9lMQKRzQR7EKUNAfDHqjQBBUkCYaY/r+/9OQACDc2jcVUNAUIc3M2s4WEDm
pQ4x/ABSQPCq8bsAFhRARsX8Ww==
    "]], 
   {RGBColor[1, 0, 0], 
    LineBox[{{69.47640163544398, 60.67704976171541}, {73.01565883512916, 
     61.99987549307406}}]}},
  PlotRange->{{-5, 105}, {-5, 105}}]], "Output",
 CellChangeTimes->{3.6380231180777407`*^9, 3.6380264308870983`*^9}]
}, Open  ]]
},
WindowSize->{1364, 716},
WindowMargins->{{-9, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7277, 157, 365, "Input"],
Cell[7838, 179, 1639, 40, 165, "Input"],
Cell[9480, 221, 37393, 776, 1683, "Input"],
Cell[CellGroupData[{
Cell[46898, 1001, 5894, 138, 231, "Input"],
Cell[52795, 1141, 141, 3, 32, "Output"],
Cell[52939, 1146, 140, 3, 32, "Output"],
Cell[53082, 1151, 1131, 21, 375, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
